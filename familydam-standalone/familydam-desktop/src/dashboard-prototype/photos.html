<!doctype html>
<!--
  ~ This file is part of FamilyDAM Project.
  ~
  ~     The FamilyDAM Project is free software: you can redistribute it and/or modify
  ~     it under the terms of the GNU General Public License as published by
  ~     the Free Software Foundation, either version 3 of the License, or
  ~     (at your option) any later version.
  ~
  ~     The FamilyDAM Project is distributed in the hope that it will be useful,
  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~     GNU General Public License for more details.
  ~
  ~     You should have received a copy of the GNU General Public License
  ~     along with the FamilyDAM Project.  If not, see <http://www.gnu.org/licenses/>.
  -->

<!--
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
<head>
    <title>FamilyDAM Vision Prototype</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <script src="components/platform/platform.js"></script>
    <script src="assets/jquery.min.js"></script>

    <link rel="import" href="components/core-scroll-header-panel/core-scroll-header-panel.html">
    <link rel="import" href="components/core-toolbar/core-toolbar.html">
    <link rel="import" href="components/core-icon-button/core-icon-button.html">
    <link rel="import" href="components/core-list/core-list.html">
    <link rel="import" href="components/core-overlay/core-overlay.html">
    <link rel="import" href="components/core-drawer-panel/core-drawer-panel.html">
    <link rel="import" href="components/paper-tabs/paper-tabs.html">
    <link rel="import" href="components/paper-tabs/paper-tab.html">
    <link rel="import" href="components/paper-fab/paper-fab.html">
    <link rel="import" href="components/paper-toggle-button/paper-toggle-button.html">
    <link rel="import" href="assets/components/dam-photo-group/dam-photo-group.html">
    <link rel="import" href="assets/components/dam-photo-lightbox/dam-photo-lightbox.html">
    <link rel="import" href="assets/components/dam-photo-details/dam-photo-details.html">
    <link rel="import" href="assets/components/file-uploader/file-uploader.html">
    <link rel="import" href="assets/components/preview-photo/preview-photo.html">

    <link type="text/css" rel="stylesheet" href="app.css"/>

    <style>
        .item
        {
            box-sizing:    border-box;
            border-bottom: 1px solid #ddd;
            cursor:        default;
            overflow:      hidden;
        }

    </style>


</head>
<body unresolved fullbleed onload="onLoadHandler()">

<div id="filePanel" layout horizontal>

    <core-scroll-header-panel flex>
        <core-toolbar class="medium-tall"  style="background-color: #5c6bc0;">
            <core-icon-button icon="arrow-back" onclick="window.location.href='index.html';"></core-icon-button>
            <div flex>FamilyDAM</div>
            <paper-tabs selected="2" style="min-width: 375px;">
                <paper-tab onclick="window.location.href='familyplanning.html';">Family</paper-tab>
                <paper-tab onclick="window.location.href='files.html';">Files</paper-tab>
                <paper-tab onclick="window.location.href='photos.html';">Photos</paper-tab>
                <paper-tab onclick="window.location.href='music.html';">Music</paper-tab>
                <paper-tab onclick="window.location.href='movies.html';">Movies</paper-tab>
                <paper-tab onclick="window.location.href='emails.html';">Emails</paper-tab>
                <paper-tab onclick="window.location.href='social.html';">Social</paper-tab>
            </paper-tabs>
            <core-icon-button icon="search"></core-icon-button>
            <core-icon-button icon="more-vert"></core-icon-button>
            <div class="middle indent title" style="margin-left: 100px;">/photos/</div>
            <div class="bottom">
                <paper-fab icon="add" onclick="toggleUploader();" style="z-index: 10"></paper-fab>
            </div>
        </core-toolbar>

        <div content>
            <div layout horizontal style="top:128px;">
                <!-- LEFT DRAWER -->
                <aside id="leftDrawer" style="background-color: #eee; width:256px; height:100%;">
                    <div horizontal layout
                         style="height: 45px; width: 100%; position:relative; left:0px; right: 0px;">
                        <div flex>

                        </div>
                        <div>
                            <paper-icon-button id="navicon" icon="menu" onClick="toggleLeftDrawer('leftDrawer')"></paper-icon-button>
                        </div>
                    </div>

                    <div id="content" style="background-color: #fff; position: absolute; width: 256px;">
                        <div id="fileTree" class="sidebar">

                            <ul style="margin-left: -20px;list-style: none;">
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <a href="familyplanning.html" style="text-decoration:none;">Family Planning (3.0)</a>
                                </li>
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <a href="files.html" style="text-decoration:none;">Files</a>
                                </li>
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <b><i>Photos</i></b>
                                    <ul style="list-style: none;">
                                        <li>
                                            <core-icon icon="folder"></core-icon>
                                            2014
                                        </li>
                                        <li>
                                            <core-icon icon="folder"></core-icon>
                                            2013
                                        </li>
                                        <li>
                                            <core-icon icon="folder"></core-icon>
                                            2012
                                        </li>
                                        <li>
                                            <core-icon icon="folder"></core-icon>
                                            2011
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <a href="music.html" style="text-decoration:none;">Music</a>
                                </li>
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <a href="movies.html" style="text-decoration:none;">Movies</a>
                                </li>
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <a href="emails.html" style="text-decoration:none;">Email Archive (2.0)</a>
                                </li>
                                <li>
                                    <core-icon icon="folder"></core-icon>
                                    <a href="social.html" style="text-decoration:none;">Social Web (2.0)</a>
                                </li>
                            </ul>
                        </div>


                        <div class="tagCloud">
                            <div style="width:100%;background-color:#FFFFFF;font-family:Arial; border: 1px solid #FFFFFF; text-align:center;">
                                <div style="padding:5px;">
                                    <a href="" style="padding:10px;font-size:12px;text-decoration:none; color: #87A800;">Landscape</a>
                                    <a href="" style="padding:10px;font-size:16px;text-decoration:none; color: #FF7600;">kids</a>
                                    <a href="" style="padding:10px;font-size:19px;text-decoration:none; color: #87A800;">Hailey</a>
                                    <a href="" style="padding:10px;font-size:16px;text-decoration:none; color: #039FAF;">Kayden</a>
                                    <a href="" style="padding:10px;font-size:14px;text-decoration:none; color: #039FAF;">mike</a>
                                    <a href="" style="padding:10px;font-size:16px;text-decoration:none; color: #DE2159;">Angie</a>
                                    <a href="" style="padding:10px;font-size:12px;text-decoration:none; color: #DE2159;">Vacation</a>
                                    <a href="" style="padding:10px;font-size:12px;text-decoration:none; color: #87A800;">Work</a>
                                    <a href="" style="padding:10px;font-size:16px;text-decoration:none; color: #FF7600;">Baseball</a>
                                    <a href="" style="padding:10px;font-size:19px;text-decoration:none; color: #87A800;">Birthday</a>
                                    <a href="" style="padding:10px;font-size:16px;text-decoration:none; color: #039FAF;">School</a>
                                    <a href=""
                                       style="padding:10px;font-size:14px;text-decoration:none; color: #039FAF;">B&W</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- MAIN -->
                <div flex style="float:left; width: 100%">
                    <div horizontal layout
                         style="height: 45px; width: 100%; background-color: #eee; position:relative; left:0px; right: 0px;">
                        <div flex>

                        </div>
                        <div layout horizontal center>
                            <label>Group By:</label>
                            <paper-button label="Date"></paper-button> |
                            <paper-button label="Location"></paper-button>
                        </div>
                        <div style="width:120px;"></div>
                    </div>

                    <div class="folder">
                        <dam-photo-group id="photoList"
                                         label="January 2014"></dam-photo-group>

                    </div>
                </div>



                <aside id="rightDrawer" style="width:350px;display:none">
                    <div horizontal layout center
                         style="height: 45px; width: 100%; background-color: #eee; ">
                        <div><h2>Preview</h2></div>
                    </div>

                    <div >
                        <dam-photo-lightbox id="photoLightbox" style="display: none"></dam-photo-lightbox>
                        <preview-photo id="photoPreview" style="display: none"></preview-photo>

                    </div>
                </aside>

            </div>
        </div>
    </core-scroll-header-panel>


</div>


<file-uploader id="uploaderOverlay"></file-uploader>

<core-overlay id="photoDetailOverlay" backdrop="true" layered="true">
    <div style="background-color: #fff">

        <dam-photo-details id="photoDetails"></dam-photo-details>
    </div>
</core-overlay>


<script>

    // custom transformation: scale header's title
    var titleStyle = document.querySelector('.title').style;
    addEventListener('core-header-transform', function (e) {
        var d = e.detail;
        var m = d.height - d.condensedHeight;
        var scale = Math.max(0.75, (m - d.y) / (m / 0.25) + 0.75);
        titleStyle.webkitTransform = titleStyle.transform =
                'scale(' + scale + ') translateZ(0)';
    });

</script>


<script>
    var photos = [];

    var toggleLeftDrawer = function(id)
    {
        if( document.querySelector("#" +id).style.width == "45px" )
        {
            document.querySelector("#" +id).style.width = "265px";
            document.querySelector("#content").style.display = "block";
        }else{
            closeLeftDrawer(id);
        }
    }

    var closeLeftDrawer = function(id){
        document.querySelector("#" +id).style.width = "45px";
        document.querySelector("#content").style.display = "none";
    }


    var toggleRightDrawer = function(id)
    {
        if( document.querySelector("#" +id).style.display == "none" )
        {
            document.querySelector("#" +id).style.display = "block";
        }else{
            closeRightDrawer(id);
        }
        //document.querySelector("#photoList").layout();
    }

    var closeRightDrawer = function(id){
        document.querySelector("#" +id).style.display = "none";
    }


    var shuffle = function (array) {
        var currentIndex = array.length, temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex)
        {

            // Pick a remaining element...
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex -= 1;

            // And swap it with the current element.
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[randomIndex];
            array[randomIndex] = temporaryValue;
        }

        return array;
    };

    var onLoadHandler = function () {
        photos = [
            {id: "001", indx:1, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "012", indx:12, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "004", indx:4, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "014", indx:14, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "013", indx:13, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "005", indx:5, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "016", indx:16, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "009", indx:9, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "007", indx:7, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "008", indx:8, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "010", indx:10, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "011", indx:11, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "002", indx:2, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "015", indx:15, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
            {id: "003", indx:3, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "006", indx:6, name: "dsc0001.jpg", date: '01/21/2014', src: "http://placehold.it/325x245", width: 325, height: 245},
            {id: "017", indx:17, name: "dsc0002.jpg", date: '01/21/2014', src: "http://placehold.it/160x245", width: 160, height: 245},
        ];
        document.querySelector("#photoList").model = photos;//shuffle(photos);
        document.querySelector("#photoList").addEventListener('photo-select', photoSelectHandler);
        document.querySelector("#photoList").addEventListener('photo-deselect', photoDeselectHandler);
        document.querySelector("#photoList").addEventListener('photo-hard-select', photoHardSelectHandler);

    };


    var toggleUploader = function () {
        document.querySelector("#uploaderOverlay").toggle();
    };


    var photoSelectHandler = function (event) {
        console.dir(event.detail);

        toggleRightDrawer("rightDrawer");

        document.querySelector("#photoLightbox").addPhoto(event.detail);
        if (document.querySelector("#photoLightbox").selectedItems.length == 1)
        {
            document.querySelector("#photoPreview").style.display = "block";
            document.querySelector("#photoLightbox").style.display = "none";
        } else
        {
            document.querySelector("#photoLightbox").style.display = "block";
            document.querySelector("#photoPreview").style.display = "none";
        }
    };

    var photoDeselectHandler = function (event) {
        console.dir(event.detail);

        document.querySelector("#photoLightbox").removePhoto(event.detail);
        if (document.querySelector("#photoLightbox").selectedItems.length == 1)
        {
            document.querySelector("#photoPreview").style.display = "block";
            document.querySelector("#photoLightbox").style.display = "none";
        } else
        {
            document.querySelector("#photoLightbox").style.display = "block";
            document.querySelector("#photoPreview").style.display = "none";
        }
    };

    var photoHardSelectHandler = function (event) {
        console.dir(event.detail);

        closeRightDrawer("rightDrawer");
        closeLeftDrawer("leftDrawer");

        document.querySelector("#photoList").unselectOthers(event.detail);
        document.querySelector("#photoLightbox").removeOthers(event.detail);

        document.querySelector("#photoDetails").model = event.detail;
        //document.querySelector("#photoDetailOverlay").toggle();
    }

</script>

</body>
</html>
